<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>求士</title>
    <script src="./react-15.1.0/build/react.js"></script>
    <script src="./react-15.1.0/build/react-dom.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.8.23/browser.min.js"></script>
    <link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/3.3.5/css/bootstrap.min.css">
     <!-- jQuery文件。务必在bootstrap.min.js 之前引入 -->
	<script src="https://cdn.bootcss.com/jquery/1.11.3/jquery.min.js"></script>

	<!-- 最新的 Bootstrap 核心 JavaScript 文件 -->
	<script src="https://cdn.bootcss.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
  <link rel="stylesheet" type="text/css" href="./css/flexslider.css" />
  <script type="text/javascript" src="./js/jquery.flexslider-min.js"></script>
  </head>
  <body>
    <div id="container">
    </div>
    <script type="text/babel">
      var COLORBOX={
      		box1: {color: "#0A974A", url:"./img/index-on.png"},
      		box2: {color: "#757575", url:"./img/focus.png"},
      		box3: {color: "#757575", url:"./img/dynamic.png"},
      		box4: {color: "#757575", url:"./img/my.png"}
      };
      var IconStyle = React.createClass({
        handleClick: function(event){
          this.props.onTouchTap(
            this.props.num
          );

          event.stopPropagation();
          event.preventDefault();
        },
      	render: function(){
      		return(
      			//TODO: active和非active状态切换
      			<a className="iconStyle col-md-3 col-sm-3" onClick={this.handleClick}>
      				<div><img src = {this.props.imgUrl} /></div>
      				<font className="categoryWord" color={this.props.colorInfo}>{this.props.title}</font>
      			</a>
      		);
      	}
      });

      var SlideBar = React.createClass({
        handleTouch: function(num){
          this.props.onChangeBox(num);
        },

     /* 	event.stopPropagation();
        event.preventDefault(); */
      	render: function(){
      		return(
      			<div className="slideBar row">
      				<IconStyle imgUrl={this.props.colorBox.box1.url} title="求士" colorInfo={this.props.colorBox.box1.color } onTouchTap={this.handleTouch} num="1" />
      				<IconStyle imgUrl={this.props.colorBox.box2.url} title="关注" colorInfo={this.props.colorBox.box2.color} onTouchTap={this.handleTouch} num="2" />
      				<IconStyle imgUrl={this.props.colorBox.box3.url} title="动态"  colorInfo={this.props.colorBox.box3.color} onTouchTap={this.handleTouch} num="3"/>
      				<IconStyle imgUrl={this.props.colorBox.box4.url} title="我的" colorInfo={this.props.colorBox.box4.color} onTouchTap={this.handleTouch} num="4"/>
      			</div>
      		);
      	}
      });

      var FlexSlider = React.createClass({
        render: function(){
          return (
            <div className="flexslider"> 
                  <ul className="slides"> 
                    <li><img src="./img/banner1.jpg" /></li> 
                    <li><img src="./img/banner2.png" /></li> 
                    <li><img src="./img/banner3.jpg" /></li>
                  </ul> 
            </div> 
            );
        }
      });
      var ContentBox = React.createClass({
        render: function(){
          return(
            <div>
              <div ref="home">
                <FlexSlider />
              </div>
              <div ref="focus">关注</div>
              <div ref="dynamic">动态</div>
              <div ref="my">我的</div>
           </div>
         );
        },
        componentDidMount: function(){
            var focus=this.refs.focus;
            var home=this.refs.home;
            var dynamic=this.refs.dynamic;
            var my=this.refs.my;
            if(this.props.boxNum==1){
              home.style.display="block";
              focus.style.display="none";
              dynamic.style.display="none";
              my.style.display="none";
            }else if(this.props.boxNum==2){
              home.style.display="none";
              focus.style.display="block";
              dynamic.style.display="none";
              my.style.display="none";
            }else if(this.props.boxNum==3){
              home.style.display="none";
              focus.style.display="none";
              dynamic.style.display="block";
              my.style.display="none";
            }else if(this.props.boxNum==4){
              home.style.display="none";
             focus.style.display="none";
              dynamic.style.display="none";
              my.style.display="block";
            }
        },
        componentDidUpdate: function(){
            var focus=this.refs.focus;
            var home=this.refs.home;
            var dynamic=this.refs.dynamic;
            var my=this.refs.my;
            if(this.props.boxNum==1){
              home.style.display="block";
              focus.style.display="none";
              dynamic.style.display="none";
              my.style.display="none";
            }else if(this.props.boxNum==2){
              home.style.display="none";
              focus.style.display="block";
              dynamic.style.display="none";
              my.style.display="none";
            }else if(this.props.boxNum==3){
              home.style.display="none";
              focus.style.display="none";
              dynamic.style.display="block";
              my.style.display="none";
            }else if(this.props.boxNum==4){
              home.style.display="none";
             focus.style.display="none";
              dynamic.style.display="none";
              my.style.display="block";
            }
        }
      });      

      var Screen = React.createClass({
        handleChangeBox: function(num){
          if(num==1){
            this.setState({
              boxNum: "1",
              colorBox: {
                box1: {color: "#0A974A", url:"./img/index-on.png"},
                box2: {color: "#757575", url:"./img/focus.png"},
                box3: {color: "#757575", url:"./img/dynamic.png"},
                box4: {color: "#757575", url:"./img/my.png"}
              }
            });
          }else if(num==2){
            this.setState({
              boxNum: "2",
              colorBox: {
                box1: {color: "#757575", url:"./img/index.png"},
                box2: {color: "#0A974A", url:"./img/focus-on.png"},
                box3: {color: "#757575", url:"./img/dynamic.png"},
                box4: {color: "#757575", url:"./img/my.png"}
              }
            });
          }else if(num==3){
            this.setState({
              boxNum: "3",
              colorBox: {
                box1: {color: "#757575", url:"./img/index.png"},
                box2: {color: "#757575", url:"./img/focus.png"},
                box3: {color: "#0A974A", url:"./img/dynamic-on.png"},
                box4: {color: "#757575", url:"./img/my.png"}
              }
            });
          }else if(num==4){
            this.setState({
              boxNum: "4",
              colorBox: {
                box1: {color: "#757575", url:"./img/index.png"},
                box2: {color: "#757575", url:"./img/focus.png"},
                box3: {color: "#757575", url:"./img/dynamic.png"},
                box4: {color: "#0A974A", url:"./img/my-on.png"}
              }
            });
          }
        },
        getInitialState: function() {
          return {
            boxNum: "1",
            colorBox: COLORBOX
          };
        },
        render: function(){
          return (
            <div className="outSider">
            <ContentBox  boxNum={this.state.boxNum}/>
            <SlideBar colorBox={this.state.colorBox} onChangeBox={this.handleChangeBox}/>
            </div>
          );
        }
      });

      ReactDOM.render(
        <Screen />,
      	document.getElementById("container")
      );
    </script>
    <script>
        $(window).load(function() {
          $('.flexslider').flexslider({
            animation: "slide"
          });
        });
    </script>
    <link rel="stylesheet" type="text/css" href="css/index.css">
  </body>
</html>